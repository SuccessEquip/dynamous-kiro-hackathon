{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "CORE Framework Methodology Schema",
  "description": "Schema defining the 4-phase, 15-question CORE Framework methodology",
  "type": "object",
  "properties": {
    "framework": {
      "type": "object",
      "properties": {
        "name": { "type": "string", "const": "CORE Framework" },
        "version": { "type": "string", "pattern": "^\\d+\\.\\d+\\.\\d+$" },
        "description": { "type": "string" },
        "phases": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string", "pattern": "^(clarify|organize|refine|equip)$" },
              "name": { "type": "string" },
              "description": { "type": "string" },
              "order": { "type": "integer", "minimum": 1, "maximum": 4 },
              "questions": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "id": { "type": "string", "pattern": "^[A-Z]-\\d{2}$" },
                    "text": { "type": "string" },
                    "guidance": { "type": "string" },
                    "ai_prompt": { "type": "string" },
                    "required": { "type": "boolean", "default": true },
                    "input_type": { 
                      "type": "string", 
                      "enum": ["text", "textarea", "select", "multiselect", "number", "date"]
                    },
                    "validation": {
                      "type": "object",
                      "properties": {
                        "min_length": { "type": "integer" },
                        "max_length": { "type": "integer" },
                        "pattern": { "type": "string" },
                        "options": { "type": "array", "items": { "type": "string" } }
                      }
                    }
                  },
                  "required": ["id", "text", "guidance", "ai_prompt", "input_type"]
                }
              },
              "actions": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "id": { "type": "string", "pattern": "^E-\\d{2}$" },
                    "name": { "type": "string" },
                    "description": { "type": "string" },
                    "output_format": { 
                      "type": "string", 
                      "enum": ["markdown", "json", "ai_prompt", "all"]
                    }
                  },
                  "required": ["id", "name", "description", "output_format"]
                }
              }
            },
            "required": ["id", "name", "description", "order", "questions"]
          },
          "minItems": 4,
          "maxItems": 4
        }
      },
      "required": ["name", "version", "description", "phases"]
    },
    "output_formats": {
      "type": "object",
      "properties": {
        "markdown": {
          "type": "object",
          "properties": {
            "template": { "type": "string" },
            "sections": { "type": "array", "items": { "type": "string" } }
          }
        },
        "json": {
          "type": "object",
          "properties": {
            "schema_version": { "type": "string" },
            "include_metadata": { "type": "boolean" }
          }
        },
        "ai_prompt": {
          "type": "object",
          "properties": {
            "intro_template": { "type": "string" },
            "context_template": { "type": "string" },
            "deliverables_by_version": {
              "type": "object",
              "properties": {
                "v1": { "type": "array", "items": { "type": "string" } },
                "v2": { "type": "array", "items": { "type": "string" } },
                "v3": { "type": "array", "items": { "type": "string" } }
              }
            }
          }
        }
      }
    }
  },
  "required": ["framework", "output_formats"]
}
